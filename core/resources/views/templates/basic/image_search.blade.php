@extends($activeTemplate . 'layouts.frontend')
@section('content')
<div class="page-wrapper">
    <section class="section aside-section">
      <div class="container-default w-container">
        <div class="w-layout-grid grid-2-columns aside-left">
          <div id="w-node-ad5e1ca4-4b39-0db6-83c4-ea1be7337629-32b2f9c1" style="transform: translate3d(0px, 0%, 0px) scale3d(1, 1, 1) rotateX(0deg) rotateY(0deg) rotateZ(0deg) skew(0deg, 0deg); opacity: 1; transform-style: preserve-3d;"  class="aside-content-left h-300vh">
            <div class="inner-container _222px _100---tablet" style="height: 100%">
              <div id="accordion">
                <div class="mg-bottom-54px">
                  <div data-hover="false" data-delay="0"  class="aside-dropdown-wrapper w-dropdown">
                    <div class="aside-dropdown-toogle w-dropdown-toggle" id="w-dropdown-toggle-1" aria-controls="w-dropdown-list-1" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0">
                      <h5>Type</h5>
                      <div class="line-square-icon link-icon-rigth"></div>
                    </div>
                    <nav style="transform: translate3d(0px, 10px, 0px) scale3d(1, 1, 1) rotateX(0deg) rotateY(0deg) rotateZ(0deg) skew(0deg, 0deg); opacity: 0; display: none;  transform-style: preserve-3d; height: 0px; " class="aside-dropdown-list w-dropdown-list" id="w-dropdown-list-1" aria-labelledby="w-dropdown-toggle-1">
                      <div class="pd-top-32px w-dyn-list">
                        <div role="list"  class="grid-1-column gap-row-24px w-dyn-items">
                          <div id="w-node-ad5e1ca4-4b39-0db6-83c4-ea1be7337636-32b2f9c1" role="listitem"  class="collection-item w-dyn-item">
                            <a href="https://stocktemplate.webflow.io/category/photography"  aria-current="page" class="category-dropdown-link w-inline-block w--current"  tabindex="0">
                              <div class="flex-horizontal start gap-8px">
                                <img src="./Photography - Stock X - Webflow Ecommerce website template_files/64303a15497e2572f68afe43_photographies-icon-stock-x-webflow-template.svg"  alt="Photography" class="image category-dropdown-link---icon" />
                                <div  class="text-100 medium color-neutral-700">
                                  Photography
                                </div>
                              </div>
                            </a>
                          </div>
                          <div id="w-node-ad5e1ca4-4b39-0db6-83c4-ea1be7337636-32b2f9c1" role="listitem" class="collection-item w-dyn-item">
                            <a href="https://stocktemplate.webflow.io/category/vectors-graphics" class="category-dropdown-link w-inline-block" tabindex="0">
                              <div class="flex-horizontal start gap-8px">
                                <img src="./Photography - Stock X - Webflow Ecommerce website template_files/64303a0171bbe338095d31b1_vectors-and-graphics-icon-stock-x-webflow-template.svg" alt="Vectors &amp; graphics" class="image category-dropdown-link---icon" />
                                <div class="text-100 medium color-neutral-700">
                                  Vectors &amp; graphics
                                </div>
                              </div>
                            </a>
                          </div>
                          <div id="w-node-ad5e1ca4-4b39-0db6-83c4-ea1be7337636-32b2f9c1"  role="listitem" class="collection-item w-dyn-item">
                            <a href="https://stocktemplate.webflow.io/category/videos" class="category-dropdown-link w-inline-block" tabindex="0">
                              <div class="flex-horizontal start gap-8px">
                                <img rc="./Photography - Stock X - Webflow Ecommerce website template_files/643039a43e90e9a9a55c8b92_videos-icon-stock-x-webflow-template.svg" alt="Videos" class="image category-dropdown-link---icon" />
                                <div class="text-100 medium color-neutral-700">
                                  Videos
                                </div>
                              </div>
                            </a>
                          </div>
                        </div>
                      </div>
                    </nav>
                  </div>
                </div>
              
                <div class="mg-bottom-32px keep">
                  <div data-hover="false" data-delay="0" class="aside-dropdown-wrapper w-dropdown">
                    <div class="aside-dropdown-toogle w-dropdown-toggle" id="w-dropdown-toggle-2" aria-controls="w-dropdown-list-2" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0">
                      <div>Color</div>
                      <div class="line-square-icon link-icon-rigth"></div>
                    </div>
                    <nav style=" transform: translate3d(0px, 10px, 0px) scale3d(1, 1, 1) rotateX(0deg) rotateY(0deg) rotateZ(0deg) skew(0deg, 0deg); opacity: 0; display: none; transform-style: preserve-3d; height: 0px; "  class="aside-dropdown-list w-dropdown-list" id="w-dropdown-list-2"                      aria-labelledby="w-dropdown-toggle-2">
                      <div class="pd-top-32px w-dyn-list">
                        <div role="list" class="grid-2-columns gap-16px grid-2-columns---tablet w-dyn-items">
                          <div  id="w-node-ad5e1ca4-4b39-0db6-83c4-ea1be7337648-32b2f9c1"  role="listitem" class="w-dyn-item">
                            <a href="https://stocktemplate.webflow.io/color/black" class="category-dropdown-link w-inline-block" tabindex="0">
                              <div class="flex-horizontal start gap-8px">
                                <div style="background-color: hsla(240,20%, 3.92%,1);" class="resource-color-dot"></div>
                                <div class="text-100 color-neutral-700">
                                  Black
                                </div>
                              </div>
                            </a>
                          </div>
                          <div id="w-node-ad5e1ca4-4b39-0db6-83c4-ea1be7337648-32b2f9c1" role="listitem" class="w-dyn-item">
                            <a href="https://stocktemplate.webflow.io/color/white" class="category-dropdown-link w-inline-block" tabindex="0" >
                              <div class="flex-horizontal start gap-8px">
                                <div style="background-color: hsla(0, 0%, 100%, 1);" class="resource-color-dot"></div>
                                <div class="text-100 color-neutral-700">
                                  White
                                </div>
                              </div>
                            </a>
                          </div>
                        </div>
                      </div>
                    </nav>
                  </div>
                </div>
              </div>
              @if ($colors->count())
              <div>
               
                @foreach ($colors as $color)
                    <li>
                        <span class="color-selector search-param" id="color-{{ $color->id }}" data-param="color" data-param_value="{{ $color->color_code }}" data-search_type="single" style="background: #{{ $color->color_code }};border: 1px solid @if ($color->color_code != 'ffffff' && $color->color_code != 'fff') #{{ $color->color_code }}; @else #bac8d3 @endif">{{ $color->name }}</span>
                    </li>
                @endforeach
                 
              </div>
            @endif
            
            @php echo getAds('728x90', 2);@endphp

            </div>
          </div>
          <div
            id="w-node-ad5e1ca4-4b39-0db6-83c4-ea1be7337651-32b2f9c1"
            class="aside-content-rigth">
            <div class="inner-container _981px width-100">
              <div class="mg-bottom-80px">
                <div
                  data-w-id="bc90223f-762d-bd0d-11e5-1536d02e72a5"
                  style="
                    background-image: url('https://assets-global.website-files.com/642ee44a50f5436e35b2f9e1/64303a175e9f378e30d6f168_photographies-banner-image-stock-x-webflow-template.jpg');
                    transform: translate3d(0px, 0%, 0px) scale3d(1, 1, 1)
                      rotateX(0deg) rotateY(0deg) rotateZ(0deg)
                      skew(0deg, 0deg);
                    opacity: 1;
                    transform-style: preserve-3d;
                  "
                  class="category-banner">
                  <div class="inner-container _635px center">
                    <div class="text-center">
                      <h1 class="display-3 color-neutral-100 mg-bottom-12px">
                        Photos
                      </h1>
                      <p class="color-neutral-200 mg-bottom-0">
                       Good photos are vitalto express your message accurately.GreenStock provides the <br>right stock photos for your projects , and social media posts and more.
                      </p>
                    </div>
                  </div>
                </div>
              </div>
              @php
                  $defaultImageContent = getContent('default_images.content', true);
                  $defaultImage = getImage('assets/images/frontend/default_images/' . @$defaultImageContent->data_values->loading_image);
              @endphp
              <div style="opacity: 1"  class="w-dyn-list">
                <div role="list"  class="grid-3-columns latest-resources-grid---page w-dyn-items">
                  @foreach($images as $image)
                  @php
                      $imageUrl = imageUrl(getFilePath('stockImage'), $image->thumb);
                  @endphp
                  <div role="listitem" class="w-dyn-item">
                    <a  href="{{ route('image.detail', [slug($image->title), $image->id]) }}" class="resource-card-wrapper w-inline-block">
                      <div class="image-wrapper">
                        <img alt="Image"  class="gallery__img lazy-loading-img" data-image_src="{{ $imageUrl }}" src="{{ $defaultImage }}" style="transform: translate3d(0px, 0px, 0px) scale3d(1, 1, 1) rotateX(0deg) rotateY(0deg)  rotateZ(0deg) skew(0deg, 0deg); transform-style: preserve-3d; " />
                      </div>
                      <div class="resource-card---video-button w-condition-invisible">
                        <img src="./Photography - Stock X - Webflow Ecommerce website template_files/64347e458126ad558f064a5e_play-button-small-icon-stock-x-webflow-template.svg" alt="Play Button - Stock X Webflow Template" class="play-button" />
                      </div>
                      <div class="resource-card-content v2">
                        <div class="text-200 color-neutral-100 mg-bottom-24px">
                          #{{$image->track_id}}
                        </div>
                        <div class="mg-top-auto">
                          <div class="flex-horizontal space-between gap-16px">
                            <div  class="flex-horizontal start gap-12px flex-wrap">
                              <div class="avatar-circle _02">
                                <img src="{{ getImage(getFilePath('userProfile') . '/' . $image->user->image, null, 'user') }}" alt="{{$image->user->firstname}}" />
                              </div>
                              <div>
                                <div class="heading-h6-size color-neutral-100">
                                  {{$image->user->firstname}}
                                </div>
                                <div class="text-50 color-neutral-300">
                                  {{date('d-M-Y', strtotime($image->upload_date))}}
                                </div>
                              </div>
                            </div>
                            <div class="resource-card-arrow">
                              <div class="line-square-icon"></div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </a>
                  </div>
                  @endforeach
                </div>
                <div role="navigation"  aria-label="List" class="w-pagination-wrapper pagination-wrapper"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
      @if (count($images) > 0)
      {{ $images->links('pagination::bootstrap-5') }}
      @endif
    </section>
  </div>
@endsection

<style>
  .gallery__img {
      width: 100%;
      height: 100%;
      border-radius: 2px;
      object-fit: cover;
      vertical-align: bottom;
      transition: all 0.3s ease;
      transform-origin: center;
      position: relative;
      z-index: -1;
  }
</style>

@push('script')
<script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>
<script>

$( function() {
  $( "#accordion" ).accordion();
});

document.addEventListener('DOMContentLoaded', function() {
  document.querySelector('.header-search-bar').style.display="none";
});

	//lazy loading image
	let images = document.querySelectorAll(".lazy-loading-img");
	function preloadImage(image) {
		const src = image.getAttribute("data-image_src");
		image.src = src;
	}

	let imageOptions = {
		threshold: 1,
	};

	const imageObserver = new IntersectionObserver((entries, imageObserver) => {
		entries.forEach((entry) => {
			if (!entry.isIntersecting) {
				return;
			} else {
				preloadImage(entry.target);
				imageObserver.unobserve(entry.target);
			}
		});
	}, imageOptions);

	images.forEach((image) => {
		imageObserver.observe(image);
	});
	//lazy loading image end

  //clear all parameter wihout specefic field
  $('.clear-all').on('click', function() {
                let url = new URL($(location).attr("href"));
                let params = new URLSearchParams(url.search);
                let searchParams = [];
                for (const key of params.keys()) {
                    if (key != 'type' && key != 'category') {
                        searchParams.push(key);
                    }
                }

                searchParams.forEach(element => {
                    params.delete(element);
                });

                const newUrl = new URL(`${url.origin}${url.pathname}?${params}`);
                window.location.href = newUrl;
            });

            // page on load active searched field
            $.each($('.search-param'), function(index, element) {
                let url = new URL($(location).attr("href"));
                let params = new URLSearchParams(url.search);

                params.forEach((value, key) => {
                    if ($(element).data('param') == key && $(element).data('param_value') == value) {
                        $(element).addClass('active');
                    }
                });
            });


            // on click search field
            $(document).on('click', '.search-param', function() {
                let searchItem = $(this);
                let link = new URL($(location).attr('href'));
                let param = $(this).data('param');
                let paramValue = $(this).data('param_value');
                let searchType = $(this).data('search_type') ?? null;
                link = removeParam(link, 'page');
                if (searchType == 'single') {
                    let sameTypeSearchField = $(`[data-param='${param}']`).not(this);

                    $.each(sameTypeSearchField, function(index, element) {
                        let params = new URLSearchParams(link.search);
                        let param = $(element).data('param');
                        let paramValue = $(element).data('param_value');

                        params.forEach((value, key) => {
                            if (param == key && paramValue == value) {
                                link = removeParam(link, param, paramValue, searchType);
                            }
                        });
                        $(element).removeClass('active');
                    });
                }

                if (searchItem.hasClass('active')) {
                    searchItem.removeClass('active');
                    link = removeParam(link, param, paramValue, searchType);
                } else {
                    searchItem.addClass('active');
                    link = appendParam(link, param, paramValue);
                }
                window.location.href = link;
            })

            // append parameter to the current route
            function appendParam(currentUrl, param = null, paramValue = null) {
                let url = new URL(currentUrl);
                const addParam = {
                    [param]: paramValue
                }
                const newParams = new URLSearchParams([
                    ...Array.from(url.searchParams.entries()),
                    ...Object.entries(addParam)
                ]);
                const newUrl = new URL(`${url.origin}${url.pathname}?${newParams}`);
                return newUrl;
            }

            //remove parameter from the current route
            function removeParam(currentUrl, param = null, paramValue = null, searchType = 'single') {
                let url = new URL(currentUrl);
                let params = new URLSearchParams(url.search);
                if (searchType == 'multiple') {
                    const multipleParams = params.getAll(param).filter(param => param != paramValue);
                    params.delete(param);
                    for (const value of multipleParams) {
                        params.append(param, value);
                    }

                } else {
                    params.delete(param);
                }
                const newUrl = new URL(`${url.origin}${url.pathname}?${params}`);
                return newUrl;
            }

            //clear individual parameter
            $('.clear-param').on('click', function() {
                let url = new URL($(location).attr("href"));
                let param = $(this).data('param');
                // console.log(param);
                url = removeParam(url, param);
                $(`span[data-param='${param}']`).removeClass('active');
                window.location.href = url;
            });
</script>
    {{-- <script>
        "use strict";

        let likeRoutes = {
            updateLike: "{{ route('user.image.like.update') }}"

        };
        let likeParams = {
            loggedStatus: @json(Auth::check()),
            csrfToken: "{{ csrf_token() }}"
        }
    </script>
    <script src="{{ asset($activeTemplateTrue . 'js/like.js') }}"></script> --}}
@endpush 
